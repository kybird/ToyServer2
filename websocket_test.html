<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        h1 { color: #4ec9b0; }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .connected { background: #0e639c; color: white; }
        .disconnected { background: #d16969; color: white; }
        input, button {
            padding: 10px;
            margin: 5px;
            border: 1px solid #3c3c3c;
            background: #252526;
            color: #d4d4d4;
            border-radius: 4px;
        }
        button {
            cursor: pointer;
            background: #0e639c;
            color: white;
        }
        button:hover { background: #1177bb; }
        #log {
            background: #252526;
            border: 1px solid #3c3c3c;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            margin-top: 20px;
        }
        .log-info { color: #4ec9b0; }
        .log-error { color: #f48771; }
        .log-message { color: #ce9178; }
    </style>
</head>
<body>
    <h1>ğŸ”Œ WebSocket í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸</h1>
    
    <div id="status" class="status disconnected">ì—°ê²° ì•ˆë¨</div>
    
    <div>
        <input type="text" id="url" value="ws://localhost:9002" style="width: 300px;">
        <button onclick="connect()">ì—°ê²°</button>
        <button onclick="disconnect()">ì—°ê²° í•´ì œ</button>
    </div>
    
    <div style="margin-top: 20px;">
        <input type="text" id="message" placeholder="ë©”ì‹œì§€ ì…ë ¥..." style="width: 500px;">
        <button onclick="sendMessage()">ì „ì†¡</button>
    </div>
    
    <div id="log"></div>

    <script>
        let ws = null;
        const logDiv = document.getElementById('log');
        const statusDiv = document.getElementById('status');

        function log(message, type = 'info') {
            const time = new Date().toLocaleTimeString();
            const className = `log-${type}`;
            logDiv.innerHTML += `<div class="${className}">[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateStatus(connected) {
            if (connected) {
                statusDiv.textContent = 'âœ… ì—°ê²°ë¨';
                statusDiv.className = 'status connected';
            } else {
                statusDiv.textContent = 'âŒ ì—°ê²° ì•ˆë¨';
                statusDiv.className = 'status disconnected';
            }
        }

        function connect() {
            const url = document.getElementById('url').value;
            
            if (ws && ws.readyState === WebSocket.OPEN) {
                log('ì´ë¯¸ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            log(`ì—°ê²° ì‹œë„: ${url}`, 'info');
            ws = new WebSocket(url);

            ws.onopen = () => {
                log('WebSocket ì—°ê²° ì„±ê³µ!', 'info');
                updateStatus(true);
            };

            ws.onmessage = (event) => {
                log(`ì„œë²„ë¡œë¶€í„° ìˆ˜ì‹ : ${event.data}`, 'message');
            };

            ws.onerror = (error) => {
                log('WebSocket ì˜¤ë¥˜ ë°œìƒ', 'error');
                console.error(error);
            };

            ws.onclose = () => {
                log('WebSocket ì—°ê²° ì¢…ë£Œ', 'info');
                updateStatus(false);
            };
        }

        function disconnect() {
            if (ws) {
                ws.close();
                ws = null;
            }
        }

        function sendMessage() {
            const message = document.getElementById('message').value;
            
            if (!ws || ws.readyState !== WebSocket.OPEN) {
                log('ë¨¼ì € ì—°ê²°í•´ì£¼ì„¸ìš”!', 'error');
                return;
            }

            if (!message) {
                log('ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'error');
                return;
            }

            ws.send(message);
            log(`ì „ì†¡: ${message}`, 'info');
            document.getElementById('message').value = '';
        }

        // Enter í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
        document.getElementById('message').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì—°ê²°
        window.onload = () => {
            log('WebSocket í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ ì¤€ë¹„ ì™„ë£Œ', 'info');
        };
    </script>
</body>
</html>
