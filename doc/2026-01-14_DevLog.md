# 2026-01-14 DevLog

## 🛠 오늘의 작업 내역
- **뱀서류 레벨업 시스템 구현**: 무기 및 패시브 아이템의 데이터 기반 관리(JSON), 인벤토리 슬롯 시스템, 레벨업 시 랜덤 선택지 제공 및 적용 로직 완성.
- **전투 효과 실시간 연동**: 플레이어의 패시브 스탯 보너스를 계산하여 `DamageEmitter`의 데미지, 쿨다운, 공격 범위, 투사체 수에 즉시 반영되도록 구현.
- **버그 수정**:
    - 서버에서 보낸 레벨업 패킷(401)을 클라이언트가 인식하지 못하던 문제(No parser) 해결.
    - 게임 오버(플레이어 사망) 이후에도 몬스터가 계속 스폰되던 문제를 `Room` 상태 관리 플래그를 통해 해결.
- **개발 환경 최적화**: MSVC 환경에서 `clangd`가 C++20 및 프로젝트 인클루드 경로를 정확히 인식하도록 `.clangd` 파일 구성 및 CMake 설정 업데이트.

## ❗️ 발생한 이슈 & 해결 방안
### 이슈 1: 클라이언트 패킷 미인식
- **증상**: 서버는 레벨업 패킷을 보내지만 클라이언트는 ID 401번에 대한 파서가 없어 무시됨.
- **해결**: 클라이언트 `PacketManager.cs`에 `S_LEVEL_UP_OPTION` 파서 등록 및 `PacketHandler`에 임시 연동 로직 추가.

### 이슈 2: 게임 오버 후 몬스터 무한 스폰
- **증상**: 플레이어가 모두 죽어 게임 오버 패킷이 나간 후에도 `WaveManager`가 계속 몬스터를 소환함.
- **해결**: `Room` 클래스에 `_isGameOver` 상태 플래그를 도입하고, 업데이트 루프에서 이 플래그가 참일 경우 `WaveManager::Update`를 건너뛰도록 수정.

## 💡 기술적 포인트
- **데이터 드리븐 설계**: 무기와 패시브의 상세 수치를 JSON으로 분리하여 코드 수정 없이 밸런싱 가능하도록 구현.
- **컴파일 데이터베이스**: MSVC 제너레이터 환경에서 `compile_commands.json` 생성이 어려울 때, `.clangd` 파일을 통해 수동으로 인클루드 경로를 지정하여 LSP 기능을 정상화함.

---

## 🚀 기술 블로그 포스팅 초안

### [개발 일지] 뱀서류 레벨업 시스템의 완성: 데이터 드리븐과 버그 사냥

안녕하세요! 오늘은 "Vampire Survivors" 스타일의 핵심 시스템 중 하나인 **레벨업 보상 시스템**을 완성하고, 개발 과정에서 만난 까다로운 버그들을 해결한 과정을 공유하려 합니다.

💡 **오늘의 도전**
플레이어가 강해지는 쾌감의 핵심인 '레벨업'을 구현하면서 두 가지 큰 난관에 부딪혔습니다. 하나는 서버에서 보낸 선택 패킷을 클라이언트가 아예 인식하지 못하는 **통신 단절** 문제였고, 다른 하나는 플레이어는 죽었는데 몬스터는 축제를 벌이며 계속 나타나는 **스폰 로직 오류**였습니다.

🛠 **해결 과정**

1. **유령 패킷 해결 (ID 401)**
클라이언트의 `PacketManager`에 레벨업 옵션 패킷(`S_LEVEL_UP_OPTION`)을 위한 파서가 누락되어 발생한 문제였습니다. 단순하지만 놓치기 쉬운 코드 한 줄을 추가하여 해결했습니다.
```csharp
// PacketManager.cs
_onRecv.Add((ushort)Protocol.MsgId.SLevelUpOption, MakePacket<S_LevelUpOption>);
_handler.Add((ushort)Protocol.MsgId.SLevelUpOption, PacketHandler.Handle_S_LevelUpOption);
```

2. **게임 오버 상태의 명확한 정의**
서버의 `Room` 객체에 `_isGameOver` 상태를 중앙 집중화하고, `Update` 루프의 첫 관문에서 몬스터 스폰 기능을 잠금처리했습니다. 덕분에 게임 종료 후 정적이고 깔끔한 상태를 유지할 수 있게 되었습니다.

3. **clangd 인텔리센스 최적화**
MSVC 환경에서 `clangd`가 프로젝트 경로를 찾지 못해 빌빌거릴 때, `.clangd` 파일을 생성하여 수동으로 이정표를 세워주었습니다. 이제 자동 완성이 칼같이 작동합니다!

📝 **배운 점 & 인사이트**
- **중앙 집중식 상태 관리**: 여러 도구(WaveManager, CombatManager 등)가 얽혀있을 때는 `Room`과 같은 부모 객체에서 명확한 상태 플래그를 관리하는 것이 로직의 꼬임을 방지하는 지름길입니다.
- **LSP 도구의 유연함**: 도구가 환경을 자동으로 분석하지 못한다면, 직접 설정 파일을 통해 가이드를 주는 것이 개발 생산성에 큰 영향을 미칠니다.
