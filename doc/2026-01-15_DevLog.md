# 2026-01-15 DevLog

## 🛠 오늘의 작업 내역

### 1. UI 및 시각적 개선
- **레벨업 카드 버그 수정**:
    - **증상**: 레벨업 시 카드가 보이지 않음 (Scale이 0으로 초기화됨).
    - **원인**: `LevelUpOptionCard` 프리팹 인스턴스화 시 `Awake`가 호출되기 전(비활성 상태)에 `Setup`이 호출되면서 초기 스케일값(`_originalScale`)이 `(0,0,0)`으로 잘못 저장됨.
    - **해결**: 불필요한 스케일 초기화 방어 코드를 제거하고, Unity 라이프사이클에 맞게 자연스럽게 `Awake`에서 원본 스케일을 캡처하도록 수정.
- **카드 레이아웃 조정**:
    - `CardContainer`의 `HorizontalLayoutGroup` 간격을 `50`에서 `20`으로 줄이고, 정렬을 `Middle Center`로 변경하여 화면 밖으로 나가는 현상 방지.

### 2. 이슈 디버깅 (진행 중)
- **총알 발사 불가 현상**:
    - **증상**: 게임 시작 후 캐릭터는 움직이나 총알이 발사되지 않음. 클라이언트 로그에 `Projectile` 스폰 패킷이 수신되지 않음. 클라이언트 재실행 시에는 정상 동작.
    - **원인 분석**:
        - 로그에서 `[GameManager] Invalid Transition: Lobby --[SceneLoadComplete]--> ???` 에러 확인.
        - 씬 로딩(`CoLoadScene`) 시작 시 `targetState`가 이미 `Loading`일 경우 상태 전환(`SetState(Loading)`)을 건너뛰는 논리 오류가 있었음.
        - 이로 인해 로딩 중에도 상태가 `Lobby`로 유지되었고, 씬 로드 완료 이벤트 발생 시 유효하지 않은 전이로 실패하거나, `InGame` 상태가 아닌 시점에서 서버 패킷(`S_SpawnObject`)을 받아 무시됨.
    - **해결**: `GameManager.cs`의 `CoLoadScene` 진입 시 조건 없이 무조건 `SetState(GameState.Loading)`을 호출하도록 수정.

---

## 🚀 기술 블로그 포스팅 초안

### [Unity/C++] UI가 안 보인다면? 라이프사이클부터 의심해라 (feat. 뱀서 만들기)

안녕하세요! 오늘도 밤새며 뱀파이어 서바이버 류 게임을 만들고 있는 개발자입니다. 🧛‍♂️
오늘은 개발 중 겪은 황당한 UI 버그와 그 해결 과정을 공유하려 합니다.

#### 👻 유령 카드의 미스터리
레벨업 시스템을 만들고 설레는 마음으로 테스트를 돌렸는데... **화면에 아무것도 안 뜹니다.**
분명히 로그에는 `LevelUpOptionCard` 3개를 생성했다고 뜨는데 말이죠.

Hierarchy 탭을 보니 오브젝트는 존재합니다. 그런데 왜 안 보일까요?
정답은 바로 **Scale: (0, 0, 0)** 이었습니다.

#### 🔍 원인 분석: Awake vs Setup
제 코드는 대략 이랬습니다.

```csharp
// LevelUpOptionCard.cs
void Awake() {
    _originalScale = transform.localScale; // (1, 1, 1) 저장... 하길 기대함
}

public void Setup(...) {
    // ... 데이터 세팅 ...
    transform.localScale = _originalScale; // (0, 0, 0) 적용??
}
```

문제는 **"비활성화된 부모 밑에 생성된 프리팹"**이었습니다.
Unity에서 `SetActive(false)`인 부모 밑에 `Instantiate`를 하면, 자식의 `Awake`는 즉시 호출되지 않습니다.
그 상태에서 제가 스크립트로 `Setup()`을 호출해버리니, `_originalScale`은 초기화되지 않은 `Vector3.zero` 상태였고, 이게 그대로 적용되어 카드가 점이 되어 사라진 것이었죠.

#### 🛠 해결: 튜닝의 끝은 순정
"혹시 0이면 1로 바꿔라" 같은 덕지덕지 방어 코드를 넣으려다 멈췄습니다.
가장 좋은 해결책은 **"굳이 건드리지 않는 것"**이었습니다.

생성 직후의 프리팹은 이미 온전한 상태입니다. 굳이 `Setup`에서 스케일을 다시 세팅할 필요가 없었죠.
불필요한 코드를 싹 지우니, Unity의 라이프사이클이 알아서 모든 걸 해결해 주었습니다.

**오늘의 교훈**: 코드가 뭔가 꼬인다면, 내가 너무 많은 것을 수동으로 제어하려 한 건 아닌지 의심해보자. Unity는 생각보다 똑똑하다.

---
*Next Step: 가끔 총알이 파업하는(안 나가는) 현상이 있는데, 클라이언트의 상태 전이 로직(`GameManager`)에 구멍이 있었네요. `if`문 하나 잘못 썼다가 패킷을 다 날려먹을 뻔했습니다. 상태 머신은 꼼꼼하게!*
